# 《计算机图形学》笔记
## 第一章 计算机图形学概述
### 什么是计算机图形学
计算机图形学是研究怎样用计算机表示、处理和显示图形的一门学科

### 什么是计算机图形学
- **图形（graphics）**：计算机图形学的研究对象

    + 能在人的视觉系统中产生视觉印象的客观对象
    + 包括自然景物、拍摄到的图片、用数学方法描述的图形等

- 构成图片的要素
    
    + 几何要素：刻画对象的轮廓、形状的点、线、面、体等
    + 非几何要素：刻画对象的颜色、材质、纹理、线型、线宽等

### 表示图形的方法
- 参数表示

    由图形的形状参数（方程或分析表达式的系数，线段的端点坐标等）+ 属性参数（颜色、线型等）来表示图形
    
    称为**参数图**或**图形（graphics）**

- 点阵表示

    枚举出图形中所有的点（强调图形由点构成）
    
    称为**像素图**或**图像（image，数字图像）**

### 图形与图像
- **图形**含有几何属性，或者说更强调场景的几何表示，是由场景的几何模型和物理属性共同描述

- **图像**纯指计算机内以位图形式表示的颜色和亮度信息

图形 --（光栅化或扫描转换）--> 图像

|图形|图像|
|:---:|:---:|
|有结构，便于编辑修改|无结构，不易编辑修改|
|能准确表示3D景物，易于生成所需的不同视图|3D景物的信息已部分丢失，很难生成不同的视图|
|生成视图需要复杂的计算|生成视图不需要复杂的计算|
|自然景物的表示很困难|自然景物的表示不困难|
|国际标准：PHIGS，STEP，OpenGL等|国际标准：JPEG，TIFF等|
|编辑软件：AutoCAD，CorelDraw|编辑软件：Photoshop|


## 第二章 计算机图形系统
### 像素与光栅
- 现代图形系统都是基于光栅的，在输出设备上看到的图像都是图形元素组成的阵列

- **像素（pixel=picture element）**：图像的基本单元。每个像素对应于图像中的某个位置或某个小区域

- **光栅（raster）**：像素的阵列

### 帧缓冲区
- **帧缓冲区（frame buffer）**：图形系统的核心部件，存储屏幕上像素的颜色信息。帧缓冲区是屏幕所显示画面的一个直接映象

- 帧缓存的每一存储单元对应屏幕上的一个像素，整个帧缓存对应一帧图像

- **分辨率（resolution）**：帧缓冲区中像素的个数。它决定了我们看到的图像的精细程度

- **深度（depth）**或**精度（precision）**：每个像素的位数

*注：全彩（真彩）色：24位，2<sup>24</sup>种颜色。也称为RGB-颜色，每个像素被赋予红、绿、蓝三基色颜色组（各8位）*

### 成像系统的三要素
- 物体/对象

- 观察者（人、照相机）

- 光源

*注：材质的属性确定光照射在物体上的效果。且对象、观察者以及光源是完全独立的*

### 亮度图像与彩色图像
- 亮度图像（luminance image）

    + 单色图像
    + 值为灰度等级
    + 类似于黑白电影和电视

- 彩色图像（color image）

    + 可以显示出色调（hue），饱和度（saturation）和亮度（lightness）
    + 不一定匹配可见光谱中的波长

### 强度和亮度
- 强度：光线能量的物理度量

- 亮度：度量我们所感知到的物体发射出的光线有多强

### 成像过程
四个主要步骤：

1. 顶点处理

2. 裁剪和图元装配

3. 光栅化

4. 片段处理

> 顶点（应用程序）→顶点处理器→ 裁剪器与图元装配器→ 光栅化器→ 片段处理器→ 像素（显示设备）

## 第三章 OpenGL 编程
### 关于 GL、GLU、GLUT 通俗的解释
- OpenGL 中的 GL 库（OpenGL Core Library）是核心库，GLU 库（OpenGL Utility Library）是实用库， GLUT 库（OpenGL Utility Toolkit Library） 库是实用工具库

- GL 是核心，GLU 是对 GL 的部分封装，GLUT 是 OpenGL 的跨平台工具库

- GL 中包含了最基本的 3D 函数，而 GLU 是对 GL 的辅助，如果数学好，不用 GLU 的情况下，也是可以做出同样的效果

- GLUT 是基本的窗口界面，是独立于 GL 和 GLU 的。如果不喜欢用 GLUT，也可以用 MFC 等代替，但是 GLUT 是跨平台的

### OpenGL 的函数
- **图元函数（primitive）**
    
    系统可以显示的低级对象或最基本的实体，包括点、线段、多边形、像素、文本和各种曲线/曲面等

- **属性函数（attribute）**

    控制图元在显示器上显示的方式：线段颜色、多边形填充模式、图标题文本的字体等

- **视图函数（viewing）**

    设置虚拟照相机的位置、朝向和镜头参数等

- **变换函数（transformation）**

    对对象进行诸如平移、旋转和缩放等变换操作

- **输入函数（input）**

    处理来自键盘、鼠标等设备的输入

- **控制函数（control）**

    与窗口系统通信，初始化程序，处理运行时的错误等

- **查询函数（query）**

    确定特定系统或设备的性能参数，查询相机参数、帧缓冲区等 API 相关的信息

### OpenGL 的状态
OpenGL 是一个**有限状态机（state machine）**的黑盒：

- 状态：持续性参数，如颜色、线型、材质属性等
- 来自应用程序的输入改变 machine 的状态或者产生可见的输出

因此，OpenGL 函数可归纳为**两大类型**：

1. 定义图元

    - 如果图元可见，则被输出
    - 顶点如何被处理以及图元的外观由状态控制

2. 改变状态

    - 属性函数、视图函数、变换函数、查询函数
    - 在 3.1 以后版本，大部分状态变量由应用程序定义并发送到着色器

### OpenGL 程序的一般结构
> 配置并开启窗口 → 初始化 OpenGL 状态 → 处理用户事件 ↔️ 绘制图像

### OpenGL GLUT 回调函数
GLUT 使用回调函数机制来进行事件处理

- 窗口绘制 `glutDisplayFunc()`

- 窗口重绘 `glutPostRedisplay()`

- 窗口改变大小 `glutReshapeFunc()`

- 键盘输入 `glutKeyboardFunc()`

- 鼠标按键 `glutMouseFunc()`

- 鼠标移动 `glutMotionFunc()`

- 空闲函数 `glutIdleFunc()`

### 视图（Viewing）
- 虚拟照相机模型：对象与照相机相互独立
    
    应用程序只需关心对象和照相机的参数设置

- 照相机只能“看到”处于**视域体**内的对象。因此，要指出照相机在场景中的位置以及投影方式——称为**“视图”方式**

- OpenGL 默认视图：**正交投影**

    镜头焦距无限大，无限远离对象

    极限情形下，投影线彼此平行，投影中心变为投影方向

    投影线与投影平面垂直

- 正交投影可以对位于照相机后面的对象成像

### 变换与视图
在 OpenGL 中投影是利用投影矩阵乘法（变换）进行的

由于只存在一个变换函数系列，因此必须先设置矩阵类型：`glMatrixMode(GL_PROJECTION)`

变换函数是累计在一起的，因此需要从单位阵开始，然后把它改变为一个定义正交投影视景体的投影矩阵：

    ```python
    glLoadIdentity()
    glOrtho(-1, 1, -1, 1, -1, 1)
    ```

### OpenGL 的几何图元
|名称|对应常量|
|:---:|:---:|
|点|GL_POINTS|
|线段|GL_LINES|
|开折线|GL\_LINE\_STRIP|
|封闭折线|GL\_LINE\_LOOP|
|多边形|GL_POLYGON|
|四边形|GL_QUADS|
|三角形|GL_TRIANGLES|
|三角形带|GL\_TRIANGLE\_STRIP|
|四边形带|GL\_QUAD\_STRIP|
|三角形扇|GL\_TRIANGLE\_FAN|

### 图元的属性
**属性（attribute）**决定图元将如何绘制，是OpenGL 状态的一部分

|图元|属性|
|:---:|:---:|
|点|颜色、大小|
|线段|颜色、宽度、模式（实线、虚线）|
|多边形|绘制模式、填充模式|
|笔划文本|字体、字号、方向|

### 颜色与状态
由`glColor()`设置的颜色成为状态的一部分，后续构造过程将使用这一颜色，直至它被修改为止

*注：颜色与其他属性不是对象的一部分，但是在渲染对象时要把这些属性赋给对象*

### 着色模型
默认状态是**平滑着色**，OpenGL 根据多边形顶点的颜色插值出来内部的颜色

另一种状态是**平面着色**，第一个顶点的颜色确定填充颜色

设置着色模型`glShadeModel(Glenum mode)`:

- 平滑模式：`GL_SMOOTH`

- 平面模式：`GL_FLAT`

### 宽高比
**宽高比（aspect ratio）**：矩形的宽度与高度之比

如果`glOrtho`和`glutInitWindowSize`设置举行的宽高比不同，则会引起对象变形

原因在于，默认的操作方式是把整个裁剪矩形映射到显示窗口里，保证宽高比

